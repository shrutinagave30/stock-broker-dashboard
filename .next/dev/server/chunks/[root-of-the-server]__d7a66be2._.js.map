{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///E:/BVB%20Notes/SDP-7th%20Sem/stockdashboard1%20%282%29/lib/stock-storage.ts"],"sourcesContent":["// Shared in-memory stock storage across all API routes\nconst userStocks: { [userId: string]: { symbol: string; price: number; lastPrice: number; priceHistory: number[] }[] } =\n  {}\n\nconst stockPrices: { [symbol: string]: number } = {\n  GOOG: Math.random() * 100 + 120,\n  TSLA: Math.random() * 100 + 200,\n  AMZN: Math.random() * 100 + 150,\n  META: Math.random() * 100 + 300,\n  NVDA: Math.random() * 100 + 550,\n}\n\nconst SUPPORTED_STOCKS = [\"GOOG\", \"TSLA\", \"AMZN\", \"META\", \"NVDA\"]\n\nconst userWatchlists: { [userId: string]: string[] } = {}\n\nexport function getUpdatedPrices() {\n  Object.keys(stockPrices).forEach((symbol) => {\n    const lastPrice = stockPrices[symbol]\n    const change = (Math.random() - 0.5) * 10\n    stockPrices[symbol] = Math.max(1, lastPrice + change)\n  })\n  return stockPrices\n}\n\nexport function getUserStocks(userId: string) {\n  const stocks = userStocks[userId] || []\n  console.log(\"[v0] getUserStocks - userId:\", userId, \"stocks count:\", stocks.length)\n  return stocks\n}\n\nexport function setUserStocks(userId: string, stocks: any[]) {\n  userStocks[userId] = stocks\n  console.log(\"[v0] setUserStocks - userId:\", userId, \"stocks count:\", stocks.length)\n}\n\nexport function addStock(userId: string, symbol: string) {\n  console.log(\"[v0] addStock - Before adding:\", {\n    userId,\n    symbol,\n    hasUserStocks: !!userStocks[userId],\n    currentCount: userStocks[userId]?.length || 0,\n  })\n\n  if (!userStocks[userId]) {\n    userStocks[userId] = []\n    console.log(\"[v0] addStock - Created new array for userId:\", userId)\n  }\n\n  if (userStocks[userId].some((s) => s.symbol === symbol)) {\n    console.log(\"[v0] addStock - Already subscribed:\", { userId, symbol })\n    return false\n  }\n\n  userStocks[userId].push({\n    symbol,\n    price: stockPrices[symbol],\n    lastPrice: stockPrices[symbol],\n    priceHistory: [stockPrices[symbol]],\n  })\n\n  console.log(\"[v0] addStock - After adding:\", {\n    userId,\n    symbol,\n    currentCount: userStocks[userId].length,\n    allUserStocks: Object.keys(userStocks).map((uid) => ({\n      userId: uid,\n      count: userStocks[uid].length,\n    })),\n  })\n\n  return true\n}\n\nexport function unsubscribeStock(userId: string, symbol: string): boolean {\n  if (!userStocks[userId]) {\n    return false\n  }\n  const index = userStocks[userId].findIndex((s) => s.symbol === symbol)\n  if (index === -1) {\n    return false\n  }\n  userStocks[userId].splice(index, 1)\n  console.log(\"[v0] unsubscribeStock - Removed:\", { userId, symbol, remainingCount: userStocks[userId].length })\n  return true\n}\n\nexport function getStockPrices() {\n  return stockPrices\n}\n\nexport function getWatchlist(userId: string): string[] {\n  return userWatchlists[userId] || []\n}\n\nexport function addToWatchlist(userId: string, symbol: string): boolean {\n  if (!userWatchlists[userId]) {\n    userWatchlists[userId] = []\n  }\n\n  if (userWatchlists[userId].includes(symbol)) {\n    return false // Already in watchlist\n  }\n\n  userWatchlists[userId].push(symbol)\n  console.log(\"[v0] addToWatchlist - Added:\", { userId, symbol, watchlistCount: userWatchlists[userId].length })\n  return true\n}\n\nexport function removeFromWatchlist(userId: string, symbol: string): boolean {\n  if (!userWatchlists[userId]) {\n    return false\n  }\n\n  const index = userWatchlists[userId].indexOf(symbol)\n  if (index === -1) {\n    return false\n  }\n\n  userWatchlists[userId].splice(index, 1)\n  console.log(\"[v0] removeFromWatchlist - Removed:\", { userId, symbol, remainingCount: userWatchlists[userId].length })\n  return true\n}\n\nexport { SUPPORTED_STOCKS }\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 198, "column": 0}, "map": {"version":3,"sources":["file:///E:/BVB%20Notes/SDP-7th%20Sem/stockdashboard1%20%282%29/app/api/watchlist/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\nimport { getWatchlist, addToWatchlist, removeFromWatchlist, getUpdatedPrices } from \"@/lib/stock-storage\"\n\nexport async function GET(request: NextRequest) {\n  const userId = request.nextUrl.searchParams.get(\"userId\")\n\n  if (!userId) {\n    return NextResponse.json({ error: \"User ID required\" }, { status: 400 })\n  }\n\n  const watchlistSymbols = getWatchlist(userId)\n  const prices = getUpdatedPrices()\n\n  const watchlistStocks = watchlistSymbols.map((symbol) => ({\n    symbol,\n    price: prices[symbol],\n    change: (Math.random() - 0.5) * 5,\n    changePercent: (Math.random() - 0.5) * 2,\n  }))\n\n  return NextResponse.json({ watchlist: watchlistStocks })\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json()\n    const { userId, symbol } = body\n\n    if (!userId || !symbol) {\n      return NextResponse.json({ error: \"User ID and symbol required\" }, { status: 400 })\n    }\n\n    const success = addToWatchlist(userId, symbol)\n\n    if (!success) {\n      return NextResponse.json({ error: \"Already in watchlist\" }, { status: 400 })\n    }\n\n    return NextResponse.json({ success: true, message: \"Added to watchlist\" })\n  } catch (error) {\n    return NextResponse.json({ error: \"Failed to add to watchlist\" }, { status: 500 })\n  }\n}\n\nexport async function DELETE(request: NextRequest) {\n  try {\n    const body = await request.json()\n    const { userId, symbol } = body\n\n    if (!userId || !symbol) {\n      return NextResponse.json({ error: \"User ID and symbol required\" }, { status: 400 })\n    }\n\n    const success = removeFromWatchlist(userId, symbol)\n\n    if (!success) {\n      return NextResponse.json({ error: \"Not in watchlist\" }, { status: 400 })\n    }\n\n    return NextResponse.json({ success: true, message: \"Removed from watchlist\" })\n  } catch (error) {\n    return NextResponse.json({ error: \"Failed to remove from watchlist\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,MAAM,SAAS,QAAQ,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC;IAEhD,IAAI,CAAC,QAAQ;QACX,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAmB,GAAG;YAAE,QAAQ;QAAI;IACxE;IAEA,MAAM,mBAAmB,IAAA,yIAAY,EAAC;IACtC,MAAM,SAAS,IAAA,6IAAgB;IAE/B,MAAM,kBAAkB,iBAAiB,GAAG,CAAC,CAAC,SAAW,CAAC;YACxD;YACA,OAAO,MAAM,CAAC,OAAO;YACrB,QAAQ,CAAC,KAAK,MAAM,KAAK,GAAG,IAAI;YAChC,eAAe,CAAC,KAAK,MAAM,KAAK,GAAG,IAAI;QACzC,CAAC;IAED,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE,WAAW;IAAgB;AACxD;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG;QAE3B,IAAI,CAAC,UAAU,CAAC,QAAQ;YACtB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA8B,GAAG;gBAAE,QAAQ;YAAI;QACnF;QAEA,MAAM,UAAU,IAAA,2IAAc,EAAC,QAAQ;QAEvC,IAAI,CAAC,SAAS;YACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAuB,GAAG;gBAAE,QAAQ;YAAI;QAC5E;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,SAAS;QAAqB;IAC1E,EAAE,OAAO,OAAO;QACd,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA6B,GAAG;YAAE,QAAQ;QAAI;IAClF;AACF;AAEO,eAAe,OAAO,OAAoB;IAC/C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG;QAE3B,IAAI,CAAC,UAAU,CAAC,QAAQ;YACtB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA8B,GAAG;gBAAE,QAAQ;YAAI;QACnF;QAEA,MAAM,UAAU,IAAA,gJAAmB,EAAC,QAAQ;QAE5C,IAAI,CAAC,SAAS;YACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAmB,GAAG;gBAAE,QAAQ;YAAI;QACxE;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,SAAS;QAAyB;IAC9E,EAAE,OAAO,OAAO;QACd,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAkC,GAAG;YAAE,QAAQ;QAAI;IACvF;AACF"}}]
}